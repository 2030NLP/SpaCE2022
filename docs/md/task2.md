

##### 2.1.2  子任务2：中文空间语义异常归因

子任务2（中文空间语义异常归因）的数据包含以下内容：

- ① qid：试题编号；
- ② context：存在空间语义异常的文本；
- ③ reasons：由若干文本片段（fragments）和一个类型标记（type）构成。
  - 每个文本片段（fragment）包含 3 个字段，分别是角色（role）、文本内容（text）和字序数组（idxes）。其中 role 与归因的类型（type）有关。

每个 reason 可能的 type 有以下 3 种：

- `A` **搭配不当**，对应 2 个文本片段，其角色 role 分别为 `text1` 和 `text2` （顺序以在 context 中的出现顺序为准）。此归因的含义是：text1 与 text2 对应的文本片段通常不会搭配在一起。如 `“text1 空气”与“text2 旁”搭配不当`、`“text1 地面”与“text2 边”搭配不当` 等。
- `B` **语义冲突**，对应 6 个文本片段，涵盖两组“空间实体-空间方位-事件”（S-P-E）的三元组，其 role 分别为 `S1 P1 E1 S2 P2 E2` 。此归因的含义是：两组 S-P-E 三元组彼此冲突，不可能同时成立。如 `“[S1 手臂, P1 垂直于地面, E1 举]”与“[S2 手臂, E2 平行于地面, E2 举]”语义冲突`、`“[S1 钥匙, P1 在桌下, E1 放]”与“[S2 钥匙, P2 桌上, E2 捡起]”`等。
- `C` **不符合常识或背景信息**，对应 3 个文本片段，即一组 S-P-E 三元组，其 role 分别为 `S P E` 。此归因的含义是：这组 S-P-E 三元组在常识中或在上下文所描述的情境中是不合理的。如 `“[S 双手, P 在裤子口袋外, E 插]”不符合常识或背景信息`、`“[S 项圈, P 脖子旁, E 戴]”不符合常识或背景信息` 等。

该任务要求参赛系统对于输入的 context 返回 reasons 数组。评价时取提交答案与参考答案中匹配程度最高的单个 reason 进行计分。

数据样例如下：

> 输入：
>
> ```json
> { "qid": "2-train-221",
>   "context": "我国著名学者童第周在1978年成功地进行了黑斑蛙的克隆试验。他将黑斑蛙的红细胞的核移入事先除去了核的黑斑蛙卵前，这种换核卵最后长成能在水中自由游泳的蝌蚪。"  }
> ```
>
> 输出：
>
> ```json
> { "qid": "2-train-221",
>   "reasons": [
>     { "fragments": [
>        { "role": "text1",  "text": "移入",
>          "idxes": [41,42]},
>        { "role": "text2",  "text": "卵前",
>          "idxes": [53,54]}],
>       "type": "A" },
>     { "fragments": [
>        { "role": "S",  "text": "黑斑蛙的红细胞的核",
>          "idxes": [32,33,34,35,36,37,38,39,40]},
>        { "role": "P",  "text": "除去了核的黑斑蛙卵前",
>          "idxes": [45,46,47,48,49,50,51,52,53,54]},
>        { "role": "E",  "text": "移入",
>          "idxes": [41,42]}],
>       "type": "C" },
>     { "fragments": [
>        { "role": "S",  "text": "红细胞的核",
>          "idxes": [36,37,38,39,40]},
>        { "role": "P",  "text": "黑斑蛙卵前",
>          "idxes": [50,51,52,53,54]},
>        { "role": "E",  "text": "移入",
>          "idxes": [41,42]}],
>       "type": "C" },
>     { "fragments": [
>        { "role": "S",  "text": "核",
>          "idxes": [40]},
>        { "role": "P",  "text": "卵前",
>          "idxes": [53,54]},
>        { "role": "E",  "text": "移入",
>          "idxes": [41,42]}],
>       "type": "C" }  ]  }
> ```

特别说明：

1. 文本片段 fragment 的字序号数组 idxes 描述了 text 中每个字符在 context 中的序号。序号从 0 开始计。请特别注意： <span class="fw-bold" style="color:var(--notice-red)">idxes 不一定连续</span> 。如描述空间方位的 P P1 P2 角色的文本可能将 context 中分离的“从北京”和“到上海”拼接在一起。
2. 在单个 reason 中，<span class="fw-bold" style="color:var(--notice-red)">每个文本内容或者具体字符不一定只出现一次</span>。尤其是对于 B 类（语义冲突）的归因，S1 与 S2、P1 与 P2 以及 E1 与 E2 都有可能具有相同的 text 和/或 idxes 。
3. 对于 B 类和 C 类的 reason ，<span style="color:var(--notice-red)">文中不一定出现某些特定的 role 内容，此时该 role 可以缺省</span>。
4. 参考答案会提供多种可能的答案，<span class="fw-bold" style="color:var(--notice-red)">参赛者可提交 A, B, C 三类答案各 1 个</span>，评分时会取答案中取得最高分的 1 个答案进行计分。<span style="color:var(--notice-red)">如果提交的 reasons 数组中包含多条同一类型的归因，那么评分时仅会取此类第 1 条归因进行计算</span>。

更详细的数据说明可参考： [SpaCE2022 数据标注文档](https://2030nlp.github.io/Sp22AnnoOL/menu) 。



#### 3.2  子任务2的评价标准

子任务2按照以下步骤计算得分，作为评价指标：

1. 取出提交结果的 reasons 中 A/B/C 每类的第 1 个 reason 作为待检查的答案。
2. 对于每个待检查的 reason （称为“待检项”），与参考答案中的 reasons （称为“参考项”）进行逐个比较，分别计算以下 3 个指标：
   - 异常类型分类准确性：即待检项与参考项的 type 是否相同。
   - 异常元素识别准确性：即待检项与参考项各个特定 role 的 text 的 *`F1`* 值，公式为 `F1 = 2 * P * R / (P + R)` ，其中 *`P`* 、 *`R`* 分别代表精确率（Precision）和召回率（Recall）。
   - 异常文本识别准确性：即待检项与参考项整个 reason 中全部 text 的 *`F1`* 值，此时不考虑 type 和 role 。
3. 找到得分最高的待检项，以此项得分计为该题最终得分。
4. 对子任务2所有题目的得分计算平均分，作为最终得分。


